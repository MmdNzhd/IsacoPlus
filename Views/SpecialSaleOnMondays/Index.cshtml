@model SpecialMondayInfo
@{
    ViewBag.Title = "مدیریت فروش ویژه دوشنبه";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section vendorstyles{
    <link rel="stylesheet" type="text/css" href="/app-assets/vendors/css/vendors-rtl.min.css">
    <link rel="stylesheet" type="text/css" href="/app-assets/vendors/css/tables/datatable/datatables.min.css">
    <link rel="stylesheet" type="text/css" href="/app-assets/vendors/css/tables/datatable/extensions/dataTables.checkboxes.css">
}
@section styles{
    <link rel="stylesheet" type="text/css" href="/app-assets/css-rtl/core/menu/menu-types/vertical-menu.css">
    <link rel="stylesheet" type="text/css" href="/app-assets/css-rtl/core/colors/palette-gradient.css">
    <link rel="stylesheet" type="text/css" href="/app-assets/css-rtl/pages/data-list-view.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/vendors/select2/css/select2.min.css" type="text/css">

    <style>
        .data-list-view-header .add-new-data-sidebar .add-new-data, .data-thumb-view-header .add-new-data-sidebar .add-new-data {
            overflow: scroll !important;
        }
    </style>
}
@section vendors{
    <script src="/app-assets/vendors/js/extensions/dropzone.min.js"></script>
    <script src="/app-assets/vendors/js/tables/datatable/datatables.min.js"></script>
    <script src="/app-assets/vendors/js/tables/datatable/datatables.buttons.min.js"></script>
    <script src="/app-assets/vendors/js/tables/datatable/datatables.bootstrap4.min.js"></script>
    <script src="/app-assets/vendors/js/tables/datatable/buttons.bootstrap.min.js"></script>
    <script src="/app-assets/vendors/js/tables/datatable/dataTables.select.min.js"></script>
    <script src="/app-assets/vendors/js/tables/datatable/datatables.checkboxes.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-sweetalert/1.0.1/sweetalert.css" integrity="sha512-f8gN/IhfI+0E9Fc/LKtjVq4ywfhYAVeMGKsECzDUHcFJ5teVwvKTqizm+5a84FINhfrgdvjX8hEJbem2io1iTA==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.css" integrity="sha512-3pIirOrwegjM6erE5gPSwkUzO+3cTjpnV9lexlNZqvupR64iZBnOOTiiLPb9M36zpMScbmUNIcHUqKD47M719g==" crossorigin="anonymous" />

}
@section scripts{
    <script src="/app-assets/js/scripts/ui/data-list-view.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>

    <script>
        $(document).ready(function () {
            $('#productList').select2();

        })
        function deleteItem(id) {
            console.log(id)
            var code = $(id).attr("id");
            var url = "/SpecialSaleOnMondays/DeleteProductFromMonday?code=" + code;
            $.ajax({
                type: "POST",
                url: url,
                data: {},
                success: function (data) {
                    if (data.status == 0) {
                        toastr.error(data.message);
                    }
                    else {
                        toastr.success(data.message);
                        $(`[id=${code}]`).parent().parent().parent().remove();

                    }

                },
                error: function (data) {
                    console.log(data)
                    toastr.warning("خطایی رخ داده است");
                    console.log(data);
                }
            });
        }

                var oTable = $('.zero-configuration').DataTable({
            processing: true,
            //serverSide: true,
            language: {
                url: "//cdn.datatables.net/plug-ins/1.10.20/i18n/Persian.json"
            },
            ajax: {
                url: '@Url.Action("GetProduct", "SpecialSaleOnMondays")',
                type: "POST",
                dataType: "json",
                delay: 1000,
                data: function (d) {
                    //d._token = $('meta[name="csrf-token"]').attr('content');
                    //d.created_start = $('input[name=created_start]').val();
                }
            },
            columns: [
                {
                    data: 'code',
                    name: 'code'
                },
                {
                    data: 'name',
                    name: 'name'
                },

                {
                    data: 'categories',
                    name: 'categories'
                }
                ,

                {
                    data: 'discount',
                    name: 'discount'
                }
                ,
                {
                    data: 'code',
                    name: 'code'
                },
            ],
            columnDefs: [
                {
                    targets: 0,
                    render: function (data, type, row) {
                        code = data;
                        return `<code>` + data + `</code>`;
                    }
                }
                , {
                    targets: 4,
                    render: function (data, type, row) {
                        return `<div ><button id=${data} class="btn btn-danger" type="button" onclick="deleteItem(this)">حذف</button></div>`
                    }
                }

            ],
        });

        $("#bannerSettingForm").submit(function (e) {
            e.preventDefault();
                var formData = new FormData(this);
                $.ajax({
                    type: "POST",
                    url: '/SpecialSaleOnMondays/TopSlider',
                    data: formData,
                    cache: false,
                    contentType: false,
                    processData: false,
                    success: function (data) {
                        if (data.status == '1') {
                            toastr.success("با موفقیت ثبت شد");
                        } else {
                            toastr.error(data.message);
                        }
                    },
                    error: function (data) {
                        toastr.warning("خطا در ثبت اطلاعات");
                        console.log(data);
                    }
                });
        })
        $("#bannerSettingBtn").click(function (e) {
            e.preventDefault();
            $("#bannerModal").modal("toggle");
        })
        //Load Edit
        function edit(id) {
            $.ajax({
                type: "Get",
                url: "/Blogs/Edit/" + id,
                data: {},
                dataType:"html",
                success: function (data) {
                    if (data.status == "0") {
                        toastr.error(data.message);
                    }
                    $("#editOrCreateDiv").html(data);
                    $(".btn-outline-primary").click();

                },
                error: function (data) {
                    toastr.warning("خطایی رخ داده است");
                    console.log(data);
                }
            });
        }
        //Edit Blog
        function del(id) {
            $.ajax({
                type: "Get",
                url: "/Blogs/Delete/" + id,
                data: {},
                success: function (data) {
                    if (data.status == "0") {
                        toastr.error(data.message);
                    } else {
                        toastr.success(data.message);
                        location.reload();
                    }

                },
                error: function (data) {
                    toastr.warning("خطایی رخ داده است");
                    console.log(data);
                }
            });
        }
        $("#create").click(function (e) {
            e.preventDefault();
            $("#CreateMondayModal").modal("toggle");
        })

        $("#CreateMondayForm").submit(function (e) {
            e.preventDefault();

            if ($("#discount").val() == null || $("#discount").val() == "") {
                toastr.error("درصد تخفیف را وارد کنید");
                return;

            }
            e.preventDefault();
            var data = JSON.stringify(serializeForm(document.querySelector('#CreateMondayForm')));
            $.ajax({
                type: "Post",
                url: "/SpecialSaleOnMondays/AddProductFromMonday",
                data: data,
                contentType:"application/json",
                success: function (data) {
                    if (data.status == "0") {
                        toastr.error(data.message);
                    } else {
                        toastr.success(data.message);
                        location.reload();

                    }

                },
                error: function (data) {
                    toastr.warning("خطایی رخ داده است");
                    console.log(data);
                }
            });
        })
    </script>
}

<div class="content-body">
    <hr />
    <div class="row">
        <button type="button" id="bannerSettingBtn" class="btn btn-success m-auto">مدیریت بنر ها</button>
    </div>

    <hr />



    <div class="content-body">
        <section id="basic-datatable" class="data-list-view-header">
            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h4 class="card-title">محصولات</h4>
                            <a class="btn btn-success offset-7" href="#" id="create"><i class="feather icon-plus"></i>ثبت جدید </a>
                        </div>
                        <div class="card-content">
                            <div class="card-body card-dashboard">
                                <div class="table-responsive">
                                    <table class="table zero-configuration">
                                        <thead>
                                            <tr>
                                                <th>کد</th>
                                                <th>نام</th>
                                                <th>دسته بندی</th>
                                                <th>درصد تخفیف</th>
                                                <th>عملیات</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>


    <div class="modal fade" id="bannerModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">

        <!-- Change class .modal-sm to change the size of the modal -->
        <div class="modal-dialog modal-lg login" role="document">
            <div class="modal-content modal-login">
                <div class="modal-body">
                    <form id="bannerSettingForm" class="ash-form hidden" method="post">
                        <div class="form-body">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="row">
                                        <h3>بنر ها</h3>
                                    </div>

                                    <div class="row">
                                        <div class="col-12 col-lg-12">
                                            <div class="row">
                                                <div class="form-group col-lg-5">
                                                    <label class="ash-lable" asp-for="SpecialMondayBanner.Title"> تیتر</label>
                                                    <input type="text" class="form-control ash-input ash-file " style=" width: 341px;" id="Title" name="Title" value="@Model.SpecialMondayBanner.Title">
                                                    @*  <span>سایز پیشنهادی :  * 750</span>*@
                                                </div>
                                            </div>
                                        </div>

                                        <h1 class="m-auto">------------------------------------------------------</h1>

                                        <div class="col-12 col-lg-12">
                                            <div class="row">
                                                <div class="form-group col-lg-3">
                                                    <label class="ash-lable" asp-for="SpecialMondayBanner.TopSliderPic1">  تصویر اول اسلایدر</label>
                                                    <input type="file" class="form-control ash-input ash-file" id="TopSliderPic1" name="TopSliderPic1">
                                                    @*  <span>سایز پیشنهادی :  * 750</span>*@
                                                </div>
                                                <div class="form-group offset-3 col-lg-6">
                                                    <img style="max-height:100%;max-width:100%" src="~/uploads/@Model.SpecialMondayBanner.TopSliderPic1" />
                                                </div>
                                            </div>
                                        </div>



                                        <div class="col-12 col-lg-12">
                                            <div class="row">
                                                <div class="form-group col-lg-3">
                                                    <label class="ash-lable" asp-for="SpecialMondayBanner.TopSliderPic2">  تصویر دوم اسلایدر</label>
                                                    <input type="file" class="form-control ash-input ash-file" id="TopSliderPic2" name="TopSliderPic2">
                                                    @*  <span>سایز پیشنهادی :  * 750</span>*@
                                                </div>
                                                <div class="form-group offset-3 col-lg-6">
                                                    <img style="max-height:100%;max-width:100%" src="~/uploads/@Model.SpecialMondayBanner.TopSliderPic2" />
                                                </div>
                                            </div>
                                        </div>





                                        <div class="col-12 col-lg-12">
                                            <div class="row">
                                                <div class="form-group col-lg-3">
                                                    <label class="ash-lable" asp-for="SpecialMondayBanner.TopSliderPic3">  تصویر سوم اسلایدر</label>
                                                    <input type="file" class="form-control ash-input ash-file" id="TopSliderPic3" name="TopSliderPic3">
                                                    @*  <span>سایز پیشنهادی :  * 750</span>*@
                                                </div>
                                                <div class="form-group offset-3 col-lg-6">
                                                    <img style="max-height:100%;max-width:100%" src="~/uploads/@Model.SpecialMondayBanner.TopSliderPic3" />
                                                </div>
                                            </div>
                                        </div>




                                        <div class="col-12 col-lg-12">
                                            <div class="row">
                                                <div class="form-group col-lg-3">
                                                    <label class="ash-lable" asp-for="SpecialMondayBanner.TopSliderPic4">  تصویر چهارم اسلایدر</label>
                                                    <input type="file" class="form-control ash-input ash-file" id="TopSliderPic4" name="TopSliderPic4">
                                                    @*  <span>سایز پیشنهادی :  * 750</span>*@
                                                </div>
                                                <div class="form-group offset-3 col-lg-6">
                                                    <img style="max-height:100%;max-width:100%" src="~/uploads/@Model.SpecialMondayBanner.TopSliderPic4" />
                                                </div>
                                            </div>
                                        </div>


                                        <div class="col-12 col-lg-12">
                                            <div class="row">
                                                <div class="form-group col-lg-3">
                                                    <label class="ash-lable" asp-for="SpecialMondayBanner.TopSliderPic5">  تصویر پنجم اسلایدر</label>
                                                    <input type="file" class="form-control ash-input ash-file" id="TopSliderPic5" name="TopSliderPic5">
                                                    @*  <span>سایز پیشنهادی :  * 750</span>*@
                                                </div>
                                                <div class="form-group offset-3 col-lg-6">
                                                    <img style="max-height:100%;max-width:100%" src="~/uploads/@Model.SpecialMondayBanner.TopSliderPic5" />
                                                </div>
                                            </div>
                                        </div>



                                        <div class="col-12 col-lg-12">
                                            <div class="row">
                                                <div class="form-group col-lg-3">
                                                    <label class="ash-lable" asp-for="SpecialMondayBanner.TopSliderPic6">  تصویر ششم اسلایدر</label>
                                                    <input type="file" class="form-control ash-input ash-file" id="TopSliderPic6" name="TopSliderPic6">
                                                    @*  <span>سایز پیشنهادی :  * 750</span>*@
                                                </div>
                                                <div class="form-group offset-3 col-lg-6">
                                                    <img style="max-height:100%;max-width:100%" src="~/uploads/@Model.SpecialMondayBanner.TopSliderPic6" />
                                                </div>
                                            </div>
                                        </div>
                                        <h1 class="m-auto">------------------------------------------------------</h1>

                                        <div class="col-12 col-lg-12">
                                            <div class="row">
                                                <div class="form-group col-lg-3">
                                                    <label class="ash-lable" asp-for="SpecialMondayBanner.LeftPic">  تصویر بنر سمت چپ </label>
                                                    <input type="file" class="form-control ash-input ash-file" id="LeftPic" name="LeftPic">
                                                    @*  <span>سایز پیشنهادی :  * 750</span>*@
                                                </div>
                                                <div class="form-group offset-3 col-lg-6">
                                                    <img style="max-height:100%;max-width:100%" src="~/uploads/@Model.SpecialMondayBanner.LeftPic" />
                                                </div>
                                            </div>
                                        </div>



                                        <div class="col-12 col-lg-12">
                                            <div class="row">
                                                <div class="form-group col-lg-3">
                                                    <label class="ash-lable" asp-for="SpecialMondayBanner.RightPic">  تصویر بنر سمت راست </label>
                                                    <input type="file" class="form-control ash-input ash-file" id="RightPic" name="RightPic">
                                                    @*  <span>سایز پیشنهادی :  * 750</span>*@
                                                </div>
                                                <div class="form-group offset-3 col-lg-6">
                                                    <img style="max-height:100%;max-width:100%" src="~/uploads/@Model.SpecialMondayBanner.RightPic" />
                                                </div>
                                            </div>
                                        </div>
                                        <h1 class="m-auto">------------------------------------------------------</h1>
                                        <div class="col-12 col-lg-12">
                                            <div class="row">
                                                <div class="form-group col-lg-3">
                                                    <label class="ash-lable" asp-for="SpecialMondayBanner.MondayVerticalBaner1">  تصویر بنر های ستونی 1 </label>
                                                    <input type="file" class="form-control ash-input ash-file" id="MondayVerticalBaner1" name="MondayVerticalBaner1">
                                                    @*  <span>سایز پیشنهادی :  * 750</span>*@
                                                </div>
                                                <div class="form-group offset-3 col-lg-6">
                                                    <img style="max-height:100%;max-width:100%" src="~/uploads/@Model.SpecialMondayBanner.MondayVerticalBaner1" />
                                                </div>
                                            </div>
                                        </div>


                                        <div class="col-12 col-lg-12">
                                            <div class="row">
                                                <div class="form-group col-lg-3">
                                                    <label class="ash-lable" asp-for="SpecialMondayBanner.MondayVerticalBaner2">  تصویر بنر های ستونی 2 </label>
                                                    <input type="file" class="form-control ash-input ash-file" id="MondayVerticalBaner2" name="MondayVerticalBaner2">
                                                    @*  <span>سایز پیشنهادی :  * 750</span>*@
                                                </div>
                                                <div class="form-group offset-3 col-lg-6">
                                                    <img style="max-height:100%;max-width:100%" src="~/uploads/@Model.SpecialMondayBanner.MondayVerticalBaner2" />
                                                </div>
                                            </div>
                                        </div>




                                        <div class="col-12 col-lg-12">
                                            <div class="row">
                                                <div class="form-group col-lg-3">
                                                    <label class="ash-lable" asp-for="SpecialMondayBanner.MondayVerticalBaner3">  تصویر بنر های ستونی 3 </label>
                                                    <input type="file" class="form-control ash-input ash-file" id="MondayVerticalBaner3" name="MondayVerticalBaner3">
                                                    @*  <span>سایز پیشنهادی :  * 750</span>*@
                                                </div>
                                                <div class="form-group offset-3 col-lg-6">
                                                    <img style="max-height:100%;max-width:100%" src="~/uploads/@Model.SpecialMondayBanner.MondayVerticalBaner3" />
                                                </div>
                                            </div>
                                        </div>



                                    </div>


                                    <div class="col-12">
                                        <button type="submit" value="Submit" class="btn btn-primary m-auto">ثبت تغییرات</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="CreateMondayModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
         aria-hidden="true">

        <!-- Change class .modal-sm to change the size of the modal -->
        <div class="modal-dialog modal-md login" role="document">
            <div class="modal-content modal-login">
                <div class="modal-body">
                    <form id="CreateMondayForm">


                        <div class="form-group ">
                            <label for="PhoneNumberAdmin"> محصول</label>

                            <select id="productList" name="Code" class="custom-select col-10 m-2">
                                <option value=" "> </option>

                                @foreach (var item in ViewBag.ProductList)
                                {
                                    <option value="@item.Code">@item.Name</option>
                                }
                            </select>

                        </div>

                        <div class="form-group ">
                            <label for="PhoneNumberAdmin"> درصد تخفیف</label>
                            <input class="form-control" type="text" maxlength="11" id="discount" name="discount">
                        </div>

                        <button type="submit" class="btn btn-block btn-light-success">ثبت</button>
                    </form>

                </div>
            </div>
        </div>
    </div>

</div>


